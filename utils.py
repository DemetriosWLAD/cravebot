#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
–£—Ç–∏–ª–∏—Ç—ã –∏ —à–∞–±–ª–æ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è CraveBreaker –±–æ—Ç–∞
"""

from datetime import datetime
from typing import Dict, List
import random

class MessageTemplates:
    def __init__(self):
        self.motivational_quotes = self._init_quotes()
    
    def _init_quotes(self) -> List[str]:
        """–ú–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ü–∏—Ç–∞—Ç—ã"""
        return [
            "üí™ –ö–∞–∂–¥–æ–µ '–Ω–µ—Ç' –∏–º–ø—É–ª—å—Å—É - —ç—Ç–æ '–¥–∞' –ª—É—á—à–µ–π –≤–µ—Ä—Å–∏–∏ —Å–µ–±—è!",
            "üåü –¢—ã —Å–∏–ª—å–Ω–µ–µ —Å–≤–æ–∏—Ö –ø—Ä–∏–≤—ã—á–µ–∫!",
            "üöÄ –ú–∞–ª–µ–Ω—å–∫–∏–µ –ø–æ–±–µ–¥—ã –≤–µ–¥—É—Ç –∫ –±–æ–ª—å—à–∏–º –∏–∑–º–µ–Ω–µ–Ω–∏—è–º!",
            "üéØ –°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –Ω–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–µ, –∞ –Ω–µ –Ω–∞ —Å–æ–≤–µ—Ä—à–µ–Ω—Å—Ç–≤–µ!",
            "üî• –¢–≤–æ—è —Å–∏–ª–∞ –≤–æ–ª–∏ —Ä–∞—Å—Ç–µ—Ç —Å –∫–∞–∂–¥—ã–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –≤—ã–±–æ—Ä–æ–º!",
            "‚≠ê –¢—ã –º–æ–∂–µ—à—å –¥–µ–ª–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –≤–µ—â–∏!",
            "üåà –ö–∞–∂–¥—ã–π –¥–µ–Ω—å - –Ω–æ–≤–∞—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å—Ç–∞—Ç—å –ª—É—á—à–µ!",
            "üíé –î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ - —ç—Ç–æ –ª—é–±–æ–≤—å –∫ –±—É–¥—É—â–µ–º—É —Å–µ–±–µ!"
        ]
    
    def get_welcome_message(self) -> str:
        """–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        return """üéâ **–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ CraveBreaker!**

–Ø –≤–∞—à –ø–æ–º–æ—â–Ω–∏–∫ –≤ –±–æ—Ä—å–±–µ —Å –Ω–∞–≤—è–∑—á–∏–≤—ã–º–∏ –ø—Ä–∏–≤—ã—á–∫–∞–º–∏ –∏ –∏–º–ø—É–ª—å—Å–∞–º–∏.

üéØ **–ß—Ç–æ —è —É–º–µ—é:**
‚Ä¢ üÜò –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ —Å–∏–ª—å–Ω–æ–º –∏–º–ø—É–ª—å—Å–µ
‚Ä¢ üìä –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–∞—à–µ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞  
‚Ä¢ üßò‚Äç‚ôÄÔ∏è –î—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ –∏ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è
‚Ä¢ ü§î –ö–æ—É—á–∏–Ω–≥–æ–≤—ã–µ –≤–æ–ø—Ä–æ—Å—ã –¥–ª—è –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏
‚Ä¢ üéÆ –û—Ç–≤–ª–µ–∫–∞—é—â–∏–µ –º–∏–Ω–∏-–∏–≥—Ä—ã
‚Ä¢ üî• –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏ –∏ –ø—Ä–∏–≤—ã—á–∫–∞–º–∏

üí° **–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
–ö–æ–≥–¥–∞ —á—É–≤—Å—Ç–≤—É–µ—Ç–µ –∏–º–ø—É–ª—å—Å –∫ –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ–º—É –ø–æ–≤–µ–¥–µ–Ω–∏—é - –ø—Ä–æ—Å—Ç–æ –Ω–∞–ø–∏—à–∏—Ç–µ –º–Ω–µ –∏–ª–∏ –Ω–∞–∂–º–∏—Ç–µ "üÜò –°—Ä–æ—á–Ω–∞—è –ø–æ–º–æ—â—å". –Ø –ø—Ä–µ–¥–ª–æ–∂—É —Ç–µ—Ö–Ω–∏–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è —Å –º–æ–º–µ–Ω—Ç–æ–º.

üèÜ **–ü–æ–º–Ω–∏—Ç–µ:** –ö–∞–∂–¥–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫–æ –º–Ω–µ –≤–º–µ—Å—Ç–æ –ø–æ–¥–¥–∞–≤–∞–Ω–∏—è –∏–º–ø—É–ª—å—Å—É - —É–∂–µ –ø–æ–±–µ–¥–∞!

–ì–æ—Ç–æ–≤—ã –Ω–∞—á–∞—Ç—å –ø—É—Ç—å –∫ –ª—É—á—à–µ–π –≤–µ—Ä—Å–∏–∏ —Å–µ–±—è?"""

    def get_main_menu_text(self) -> str:
        """–¢–µ–∫—Å—Ç –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é"""
        quote = random.choice(self.motivational_quotes)
        
        return f"""üè† **–ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é CraveBreaker**

{quote}

–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:

üÜò **–°—Ä–æ—á–Ω–∞—è –ø–æ–º–æ—â—å** - —ç–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –∏–º–ø—É–ª—å—Å–µ
üî• **–ù–æ–≤—ã–π —Ç—Ä–∏–≥–≥–µ—Ä** - –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–∏–≤—ã—á–∫—É –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è  
üìä **–ú–æ—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** - –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å
üìñ **–û CraveBreaker** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ

üí¨ –í –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –Ω–∞–ø–∏—à–∏—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é."""

    def get_help_message(self) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–º–æ—â–∏"""
        return """‚ùì **–°–ø—Ä–∞–≤–∫–∞ –ø–æ CraveBreaker**

ü§ñ **–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:**
‚Ä¢ `/start` - –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –±–æ—Ç–∞
‚Ä¢ `/menu` - –ø–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
‚Ä¢ `/stats` - –ø–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
‚Ä¢ `/help` - —ç—Ç–∞ —Å–ø—Ä–∞–≤–∫–∞

üÜò **–ö–∞–∫ –ø–æ–ª—É—á–∏—Ç—å –ø–æ–º–æ—â—å:**
1. –ù–∞–∂–º–∏—Ç–µ "üÜò –°—Ä–æ—á–Ω–∞—è –ø–æ–º–æ—â—å" –∏–ª–∏ –Ω–∞–ø–∏—à–∏—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
2. –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏: –¥—ã—Ö–∞–Ω–∏–µ, –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –∏–≥—Ä–∞
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º
4. –û—Ç–º–µ—Ç—å—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

üî• **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∏–≥–≥–µ—Ä–∞–º–∏:**
‚Ä¢ –î–æ–±–∞–≤–ª—è–π—Ç–µ –ø—Ä–∏–≤—ã—á–∫–∏, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ –±–æ—Ä–µ—Ç–µ—Å—å
‚Ä¢ –û—Ç—Å–ª–µ–∂–∏–≤–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–µ—Å—Å –ø–æ –∫–∞–∂–¥–æ–π
‚Ä¢ –ü–æ–ª—É—á–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:**
‚Ä¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∑–∞ –ø–æ–º–æ—â—å—é
‚Ä¢ –ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—à–Ω—ã—Ö —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–π –∏–º–ø—É–ª—å—Å–∞–º
‚Ä¢ –ü—Ä–æ–≥—Ä–µ—Å—Å –∑–∞ –Ω–µ–¥–µ–ª—é/–º–µ—Å—è—Ü
‚Ä¢ –í–∞—à–∏ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ç—Ä–∏–≥–≥–µ—Ä—ã

üí° **–°–æ–≤–µ—Ç—ã:**
‚Ä¢ –û–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∑–∞ –ø–æ–º–æ—â—å—é –ø—Ä–∏ –ø–µ—Ä–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö –∏–º–ø—É–ª—å—Å–∞
‚Ä¢ –û—Ç–º–µ—á–∞–π—Ç–µ —á–µ—Å—Ç–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–π
‚Ä¢ –î–æ–±–∞–≤–ª—è–π—Ç–µ –≤—Å–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø—Ä–∏–≤—ã—á–∫–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ —Ç—Ä–µ–∫–∏–Ω–≥–∞
‚Ä¢ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–æ—Ç–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –¥–ª—è —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–æ–≤–æ–π –ø—Ä–∏–≤—ã—á–∫–∏"""

    def get_about_message(self) -> str:
        """–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–æ—Ç–µ"""
        return """üìñ **–û CraveBreaker**

üéØ **–ú–∏—Å—Å–∏—è:**
–ü–æ–º–æ—á—å –ª—é–¥—è–º –æ–±—Ä–µ—Å—Ç–∏ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Å–≤–æ–∏–º–∏ –∏–º–ø—É–ª—å—Å–∞–º–∏ –∏ –ø—Ä–∏–≤—ã—á–∫–∞–º–∏ —á–µ—Ä–µ–∑ –ø–æ–¥–¥–µ—Ä–∂–∫—É –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã.

üß† **–ù–∞—É—á–Ω–∞—è –æ—Å–Ω–æ–≤–∞:**
–ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã:
‚Ä¢ –¢–µ—Ö–Ω–∏–∫–∏ –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ—Å—Ç–∏ (mindfulness)
‚Ä¢ –ö–æ–≥–Ω–∏—Ç–∏–≤–Ω–æ-–ø–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏
‚Ä¢ –î—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ –¥–ª—è —Å–Ω–∏–∂–µ–Ω–∏—è —Å—Ç—Ä–µ—Å—Å–∞
‚Ä¢ –û—Ç–≤–ª–µ—á–µ–Ω–∏–µ –≤–Ω–∏–º–∞–Ω–∏—è –≤ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã

üìä **–ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã:**
1. **–ú–æ–º–µ–Ω—Ç –≤—ã–±–æ—Ä–∞** - –≤—ã —á—É–≤—Å—Ç–≤—É–µ—Ç–µ –∏–º–ø—É–ª—å—Å
2. **–ü–∞—É–∑–∞** - –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫ –±–æ—Ç—É –≤–º–µ—Å—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–∞–∫—Ü–∏–∏
3. **–ò–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏—è** - —Ç–µ—Ö–Ω–∏–∫–∞ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
4. **–ù–æ–≤—ã–π –≤—ã–±–æ—Ä** - –æ—Å–æ–∑–Ω–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
5. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ** - —Ñ–∏–∫—Å–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

üî¨ **–ü–æ—á–µ–º—É —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
‚Ä¢ –°–æ–∑–¥–∞–µ—Ç –ø–∞—É–∑—É –º–µ–∂–¥—É –∏–º–ø—É–ª—å—Å–æ–º –∏ –¥–µ–π—Å—Ç–≤–∏–µ–º
‚Ä¢ –ê–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –ø—Ä–µ—Ñ—Ä–æ–Ω—Ç–∞–ª—å–Ω—É—é –∫–æ—Ä—É (–∑–æ–Ω–∞ —Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è)
‚Ä¢ –ú–µ–Ω—è–µ—Ç —Ñ–æ–∫—É—Å –≤–Ω–∏–º–∞–Ω–∏—è
‚Ä¢ –£–∫—Ä–µ–ø–ª—è–µ—Ç –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–≤—è–∑–∏ —Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—è

üë• **–ö–æ–º—É –ø–æ–º–æ–≥–∞–µ—Ç:**
‚Ä¢ –ë–æ—Ä—é—â–∏–º—Å—è —Å –ø–µ—Ä–µ–µ–¥–∞–Ω–∏–µ–º
‚Ä¢ –ë—Ä–æ—Å–∞—é—â–∏–º –∫—É—Ä–∏—Ç—å
‚Ä¢ –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞—é—â–∏–º –∞–ª–∫–æ–≥–æ–ª—å
‚Ä¢ –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É—é—â–∏–º –≤—Ä–µ–º—è –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö
‚Ä¢ –ü—Ä–µ–æ–¥–æ–ª–µ–≤–∞—é—â–∏–º –ø—Ä–æ–∫—Ä–∞—Å—Ç–∏–Ω–∞—Ü–∏—é

üöÄ **–í–µ—Ä—Å–∏—è:** MVP 1.0
üìÖ **–†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ:** 2025

**–ü–æ–º–Ω–∏—Ç–µ:** –°–∏–ª–∞ –≤–æ–ª–∏ - —ç—Ç–æ –Ω–∞–≤—ã–∫, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–Ω–æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∞—Ç—å! üí™"""

    def get_stats_message(self, stats: Dict) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        registration_date = datetime.fromisoformat(stats['registration_date']).strftime('%d.%m.%Y')
        days_since_registration = (datetime.now() - datetime.fromisoformat(stats['registration_date'])).days
        
        # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–æ—Ç–∏–≤–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
        if stats['success_rate'] >= 80:
            motivation = "üèÜ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω—ã–π —Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å! –í—ã - —á–µ–º–ø–∏–æ–Ω!"
        elif stats['success_rate'] >= 60:
            motivation = "üí™ –û—Ç–ª–∏—á–Ω—ã–π –ø—Ä–æ–≥—Ä–µ—Å—Å! –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –≤ —Ç–æ–º –∂–µ –¥—É—Ö–µ!"
        elif stats['success_rate'] >= 40:
            motivation = "üìà –•–æ—Ä–æ—à–∞—è –¥–∏–Ω–∞–º–∏–∫–∞! –ö–∞–∂–¥–∞—è –ø–æ–ø—ã—Ç–∫–∞ –¥–µ–ª–∞–µ—Ç –≤–∞—Å —Å–∏–ª—å–Ω–µ–µ!"
        elif stats['success_rate'] >= 20:
            motivation = "üå± –í—ã –Ω–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –ø—É—Ç–∏! –ù–µ —Å–¥–∞–≤–∞–π—Ç–µ—Å—å!"
        else:
            motivation = "üöÄ –ö–∞–∂–¥–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ –∫–æ –º–Ω–µ - —É–∂–µ —à–∞–≥ –∫ –ø–æ–±–µ–¥–µ!"

        triggers_text = ""
        if stats['triggers']:
            triggers_text = "üî• **–í–∞—à–∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã:**\n" + "\n".join([f"‚Ä¢ {trigger}" for trigger in stats['triggers']]) + "\n\n"

        return f"""üìä **–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**

{motivation}

üìÖ **–° –Ω–∞–º–∏ —Å:** {registration_date} ({days_since_registration} –¥–Ω.)

üÜò **–í—Å–µ–≥–æ –æ–±—Ä–∞—â–µ–Ω–∏–π –∑–∞ –ø–æ–º–æ—â—å—é:** {stats['total_requests']}
üí™ **–ò–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–π –ø—Ä–æ–≤–µ–¥–µ–Ω–æ:** {stats['total_interventions']}
‚úÖ **–£—Å–ø–µ—à–Ω—ã—Ö —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–π:** {stats['successful_interventions']}
üìà **–ü—Ä–æ—Ü–µ–Ω—Ç —É—Å–ø–µ—Ö–∞:** {stats['success_rate']:.1f}%

üìÜ **–ó–∞ –ø–æ—Å–ª–µ–¥–Ω—é—é –Ω–µ–¥–µ–ª—é:**
‚Ä¢ –û–±—Ä–∞—â–µ–Ω–∏–π: {stats['weekly_requests']}
‚Ä¢ –£—Å–ø–µ—à–Ω—ã—Ö: {stats['weekly_successes']}

{triggers_text}üéØ **–°–æ–≤–µ—Ç:** {self._get_advice_based_on_stats(stats)}"""

    def _get_advice_based_on_stats(self, stats: Dict) -> str:
        """–ü–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–æ–≤–µ—Ç –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
        if stats['total_requests'] == 0:
            return "–î–æ–±–∞–≤—å—Ç–µ —Å–≤–æ–∏ —Ç—Ä–∏–≥–≥–µ—Ä—ã –∏ –Ω–µ —Å—Ç–µ—Å–Ω—è–π—Ç–µ—Å—å –æ–±—Ä–∞—â–∞—Ç—å—Å—è –∑–∞ –ø–æ–º–æ—â—å—é!"
        
        if stats['success_rate'] >= 80:
            return "–í–∞—à —Å–∞–º–æ–∫–æ–Ω—Ç—Ä–æ–ª—å –≤–ø–µ—á–∞—Ç–ª—è–µ—Ç! –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å –æ–ø—ã—Ç–æ–º —Å –¥—Ä—É–∑—å—è–º–∏."
        elif stats['success_rate'] >= 60:
            return "–û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ —Ç–∏–ø—ã –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–π."
        elif stats['success_rate'] >= 40:
            return "–•–æ—Ä–æ—à–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å! –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–µ—Ö–Ω–∏–∫–∞–º–∏."
        elif stats['weekly_requests'] > stats['weekly_successes'] * 2:
            return "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—ã—Ö–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Ö–Ω–∏–∫–∏ - –æ–Ω–∏ —á–∞—Å—Ç–æ —Å–∞–º—ã–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–µ."
        else:
            return "–ì–ª–∞–≤–Ω–æ–µ - –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –ø–æ–ø—ã—Ç–∫–∏. –ö–∞–∂–¥–∞—è —Ç—Ä–µ–Ω–∏—Ä—É–µ—Ç –≤–∞—à—É —Å–∏–ª—É –≤–æ–ª–∏!"

    def get_intervention_success_message(self) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏"""
        messages = [
            "üéâ –ü–æ–∑–¥—Ä–∞–≤–ª—è—é! –í—ã –ø–æ–±–µ–¥–∏–ª–∏ –∏–º–ø—É–ª—å—Å!",
            "üí™ –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞! –í–∞—à–∞ —Å–∏–ª–∞ –≤–æ–ª–∏ —Ä–∞—Å—Ç–µ—Ç!",
            "üåü –ë—Ä–∞–≤–æ! –≠—Ç–æ –Ω–∞—Å—Ç–æ—è—â–∞—è –ø–æ–±–µ–¥–∞!",
            "üèÜ –ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–æ! –í—ã –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç–µ —Å–∏—Ç—É–∞—Ü–∏—é!",
            "‚ú® –í–µ–ª–∏–∫–æ–ª–µ–ø–Ω–æ! –ö–∞–∂–¥–∞—è —Ç–∞–∫–∞—è –ø–æ–±–µ–¥–∞ –≤–∞–∂–Ω–∞!",
            "üöÄ –§–∞–Ω—Ç–∞—Å—Ç–∏–∫–∞! –í—ã —Å—Ç–∞–Ω–æ–≤–∏—Ç–µ—Å—å —Å–∏–ª—å–Ω–µ–µ!",
            "‚≠ê –ú–æ–ª–æ–¥–µ—Ü! –≠—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–ª–æ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –º—É–∂–µ—Å—Ç–≤–∞!"
        ]
        return random.choice(messages)

    def get_intervention_failure_message(self) -> str:
        """–°–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –Ω–µ—É—Å–ø–µ—à–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–µ–Ω—Ü–∏–∏"""
        messages = [
            "üòî –ù–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ! –ë–æ—Ä—å–±–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è.",
            "üíù –í–∞–∂–Ω–æ, —á—Ç–æ –≤—ã –ø–æ–ø—ã—Ç–∞–ª–∏—Å—å! –≠—Ç–æ —É–∂–µ –ø—Ä–æ–≥—Ä–µ—Å—Å.",
            "üå± –ö–∞–∂–¥–∞—è –ø–æ–ø—ã—Ç–∫–∞ –¥–µ–ª–∞–µ—Ç –≤–∞—Å —Å–∏–ª—å–Ω–µ–µ.",
            "ü§ó –ù–µ —Ä–∞—Å—Å—Ç—Ä–∞–∏–≤–∞–π—Ç–µ—Å—å. –ó–∞–≤—Ç—Ä–∞ –Ω–æ–≤—ã–π –¥–µ–Ω—å!",
            "üìà –ù–µ—É–¥–∞—á–∏ - —á–∞—Å—Ç—å –ø—É—Ç–∏ –∫ —É—Å–ø–µ—Ö—É.",
            "üí™ –ì–ª–∞–≤–Ω–æ–µ - –Ω–µ —Å–¥–∞–≤–∞—Ç—å—Å—è!",
            "üéØ –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –¥—Ä—É–≥—É—é —Ç–µ—Ö–Ω–∏–∫—É –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑."
        ]
        return random.choice(messages)

class Formatters:
    @staticmethod
    def format_duration(seconds: int) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤ —á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥"""
        if seconds < 60:
            return f"{seconds} —Å–µ–∫"
        elif seconds < 3600:
            minutes = seconds // 60
            return f"{minutes} –º–∏–Ω"
        else:
            hours = seconds // 3600
            minutes = (seconds % 3600) // 60
            return f"{hours}—á {minutes}–º"
    
    @staticmethod
    def format_percentage(value: float) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤"""
        return f"{value:.1f}%"
    
    @staticmethod
    def format_date(date_str: str) -> str:
        """–§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç—ã –≤ —á–∏—Ç–∞–µ–º—ã–π –≤–∏–¥"""
        try:
            date = datetime.fromisoformat(date_str)
            return date.strftime('%d.%m.%Y %H:%M')
        except:
            return date_str

class ValidationUtils:
    @staticmethod
    def is_valid_trigger_name(name: str) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–Ω–æ—Å—Ç–∏ –∏–º–µ–Ω–∏ —Ç—Ä–∏–≥–≥–µ—Ä–∞"""
        if not name or len(name.strip()) < 2:
            return False
        if len(name.strip()) > 50:
            return False
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞ –Ω–µ–¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Å–∏–º–≤–æ–ª—ã
        forbidden_chars = ['<', '>', '&', '"', "'"]
        return not any(char in name for char in forbidden_chars)
    
    @staticmethod
    def sanitize_user_input(text: str) -> str:
        """–û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞"""
        if not text:
            return ""
        # –£–¥–∞–ª—è–µ–º –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
        forbidden_chars = ['<', '>', '&', '"', "'"]
        for char in forbidden_chars:
            text = text.replace(char, '')
        return text.strip()[:100]  # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–ª–∏–Ω—É
